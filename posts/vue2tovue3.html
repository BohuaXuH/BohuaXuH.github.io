<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="author" content="xu"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="revisit-after" content="7 days"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="alternate" type="application/rss+xml" title="XUBOHUA's Blog" href="/feed.xml"><meta name="msapplication-TileColor" content="#ffffff"><meta name="theme-color" content="#ffffff"><title>vue2到vue3</title><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="module" crossorigin="" src="/assets/app.ee590e58.js"></script><style>*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}body{margin:0;line-height:inherit}h1,h2,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}h1,h2,h3,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}img,svg{display:block;vertical-align:middle}img{max-width:100%;height:auto}:root{--c-bg:#fff;--c-scrollbar:#eee;--c-scrollbar-hover:#bbb}html{background-color:var(--c-bg)}html{overflow:scroll}*{scrollbar-color:var(--c-scrollbar) var(--c-bg)}.prose{color:var(--fg);max-width:65ch;font-size:1rem;line-height:1.75}.prose a{color:var(--fg-deeper);text-decoration:none;font-weight:500}.prose ul>li{position:relative;padding-left:1.75em}.prose ul>li:before{content:"";position:absolute;background-color:#d1d5db;border-radius:50%;width:.375em;height:.375em;top:.6875em;left:.25em}.prose h1{color:var(--fg-deeper);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose h2{color:var(--fg-deep);font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose h3{color:inherit;font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6;opacity:.7}.prose code{color:var(--fg-deep);font-weight:600;font-size:.875em}.prose code:before{content:"`"}.prose code:after{content:"`"}.prose pre{color:#e5e7eb;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose pre code:before{content:none}.prose pre code:after{content:none}.prose p{margin-top:1.25em;margin-bottom:1.25em}.prose img{margin-top:2em;margin-bottom:2em}.prose ul{margin-top:1.25em;margin-bottom:1.25em;list-style-type:none}.prose li{margin-top:.5em;margin-bottom:.5em}.prose>ul>li p{margin-top:.75em;margin-bottom:.75em}.prose ul ul{margin-top:.75em;margin-bottom:.75em}.prose>:first-child{margin-top:0}.prose>:last-child{margin-bottom:0}.prose pre:not(.shiki){padding:0;margin:0;background:0 0}.prose .shiki{font-family:DM Mono,Input Mono,Fira Code,monospace;font-size:1.05em;line-height:1.4;margin:.5em 0}.prose img{width:100%}.shiki-light{background:#f8f8f8!important}.shiki-dark{background:#0e0e0e!important}html:not(.dark) .shiki-dark{display:none}.prose{--fg:#555;--fg-deep:#222;--fg-deeper:#000;color:var(--fg)}.prose a{font-weight:inherit;text-decoration:none;border-bottom:1px solid rgba(125,125,125,.3);transition:border .3s ease-in-out}.prose a:hover{border-bottom:1px solid var(--fg)}a.header-anchor{float:left;margin-top:.125em;margin-left:-1.2em;padding-right:.5em;font-size:.85em;opacity:0;text-decoration:none;border:0!important}a.header-anchor:focus,a.header-anchor:hover{text-decoration:none}h2:focus .header-anchor,h2:hover .header-anchor,h3:focus .header-anchor,h3:hover .header-anchor{opacity:.5}@media (max-width:1200px){.table-of-contents{display:none}}.table-of-contents{position:fixed;top:80px;padding-top:70px;font-size:.8em;right:10px;width:200px;bottom:0;overflow-y:auto;overflow-x:hidden;text-overflow:ellipsis;opacity:0;transition:all .4s ease-out}.table-of-contents:hover{opacity:.5}.table-of-contents ul>li:before{display:none}.table-of-contents ul>li{padding-left:.8rem}*,::after,::before{--un-rotate:0;--un-rotate-x:0;--un-rotate-y:0;--un-rotate-z:0;--un-scale-x:1;--un-scale-y:1;--un-scale-z:1;--un-skew-x:0;--un-skew-y:0;--un-translate-x:0;--un-translate-y:0;--un-translate-z:0;--un-scroll-snap-strictness:proximity;--un-border-spacing-x:0;--un-border-spacing-y:0;--un-ring-offset-shadow:0 0 rgba(0,0,0,0);--un-ring-shadow:0 0 rgba(0,0,0,0);--un-shadow:0 0 rgba(0,0,0,0);--un-ring-offset-width:0px;--un-ring-offset-color:#fff;--un-ring-width:0px;--un-ring-color:rgba(147,197,253,0.5)}[i-bi-badge-3d=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 16 16' display='inline-block' height='1.2em' width='1.2em' vertical-align='text-bottom' xmlns='http://www.w3.org/2000/svg' %3E%3Cg fill='currentColor'%3E%3Cpath d='M4.52 8.368h.664c.646 0 1.055.378 1.06.9c.008.537-.427.919-1.086.919c-.598-.004-1.037-.325-1.068-.756H3c.03.914.791 1.688 2.153 1.688c1.24 0 2.285-.66 2.272-1.798c-.013-.953-.747-1.38-1.292-1.432v-.062c.44-.07 1.125-.527 1.108-1.375c-.013-.906-.8-1.57-2.053-1.565c-1.31.005-2.043.734-2.074 1.67h1.103c.022-.391.383-.751.936-.751c.532 0 .928.33.928.813c.004.479-.383.835-.928.835h-.632v.914zm3.606-3.367V11h2.189C12.125 11 13 9.893 13 7.985c0-1.894-.861-2.984-2.685-2.984H8.126zm1.187.967h.844c1.112 0 1.621.686 1.621 2.04c0 1.353-.505 2.02-1.621 2.02h-.844v-4.06z'/%3E%3Cpath d='M14 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h12zM2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2z'/%3E%3C/g%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;height:1.2em;width:1.2em;vertical-align:text-bottom}[i-material-symbols-edit-document-outline-rounded=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' height='1.2em' width='1.2em' vertical-align='text-bottom' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M6 22q-.825 0-1.412-.587Q4 20.825 4 20V4q0-.825.588-1.413Q5.175 2 6 2h7.175q.4 0 .763.15q.362.15.637.425l4.85 4.85q.275.275.425.637q.15.363.15.763V12h-2V9h-4q-.425 0-.712-.288Q13 8.425 13 8V4H6v16h6v2Zm0-2V4v16Zm12.3-5.475l1.075 1.075l-3.875 3.85v1.05h1.05l3.875-3.85l1.05 1.05l-4 4q-.15.15-.338.225q-.187.075-.387.075H14.5q-.2 0-.35-.15q-.15-.15-.15-.35v-2.25q0-.2.075-.387q.075-.188.225-.338Zm3.175 3.175L18.3 14.525l1.45-1.45q.275-.275.7-.275q.425 0 .7.275l1.775 1.775q.275.275.275.7q0 .425-.275.7Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;height:1.2em;width:1.2em;vertical-align:text-bottom}[i-ri-article-line=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' height='1.2em' width='1.2em' vertical-align='text-bottom' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M20 22H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1zm-1-2V4H5v16h14zM7 6h4v4H7V6zm0 6h10v2H7v-2zm0 4h10v2H7v-2zm6-9h4v2h-4V7z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;height:1.2em;width:1.2em;vertical-align:text-bottom}[i-ri-lightbulb-line=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' height='1.2em' width='1.2em' vertical-align='text-bottom' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M9.973 18H11v-5h2v5h1.027c.132-1.202.745-2.194 1.74-3.277c.113-.122.832-.867.917-.973a6 6 0 1 0-9.37-.002c.086.107.807.853.918.974c.996 1.084 1.609 2.076 1.741 3.278zM10 20v1h4v-1h-4zm-4.246-5a8 8 0 1 1 12.49.002C17.624 15.774 16 17 16 18.5V21a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-2.5C8 17 6.375 15.774 5.754 15z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;height:1.2em;width:1.2em;vertical-align:text-bottom}[i-uil-github-alt=""]{--un-icon:url("data:image/svg+xml;utf8,%3Csvg preserveAspectRatio='xMidYMid meet' viewBox='0 0 24 24' display='inline-block' height='1.2em' width='1.2em' vertical-align='text-bottom' xmlns='http://www.w3.org/2000/svg' %3E%3Cpath fill='currentColor' d='M10.07 20.503a1 1 0 0 0-1.18-.983c-1.31.24-2.963.276-3.402-.958a5.708 5.708 0 0 0-1.837-2.415a1.2 1.2 0 0 1-.167-.11a1 1 0 0 0-.93-.645h-.005a1 1 0 0 0-1 .995c-.004.815.81 1.338 1.141 1.514a4.44 4.44 0 0 1 .924 1.36c.365 1.023 1.423 2.576 4.466 2.376l.003.098l.004.268a1 1 0 0 0 2 0l-.005-.318c-.005-.19-.012-.464-.012-1.182ZM20.737 5.377a5.39 5.39 0 0 0 .09-.42a6.278 6.278 0 0 0-.408-3.293a1.002 1.002 0 0 0-.615-.58c-.356-.12-1.67-.357-4.184 1.25a13.87 13.87 0 0 0-6.354 0C6.762.75 5.455.966 5.102 1.079a.997.997 0 0 0-.631.584a6.3 6.3 0 0 0-.404 3.357c.025.127.051.246.079.354a6.27 6.27 0 0 0-1.256 3.83a8.422 8.422 0 0 0 .043.921c.334 4.603 3.334 5.984 5.424 6.459a4.591 4.591 0 0 0-.118.4a1 1 0 0 0 1.942.479a1.678 1.678 0 0 1 .468-.878a1 1 0 0 0-.546-1.745c-3.454-.395-4.954-1.802-5.18-4.899a6.61 6.61 0 0 1-.033-.738a4.258 4.258 0 0 1 .92-2.713a3.022 3.022 0 0 1 .195-.231a1 1 0 0 0 .188-1.025a3.388 3.388 0 0 1-.155-.555a4.094 4.094 0 0 1 .079-1.616a7.543 7.543 0 0 1 2.415 1.18a1.009 1.009 0 0 0 .827.133a11.777 11.777 0 0 1 6.173.001a1.005 1.005 0 0 0 .83-.138a7.572 7.572 0 0 1 2.406-1.19a4.04 4.04 0 0 1 .087 1.578a3.205 3.205 0 0 1-.169.607a1 1 0 0 0 .188 1.025c.078.087.155.18.224.268A4.122 4.122 0 0 1 20 9.203a7.039 7.039 0 0 1-.038.777c-.22 3.056-1.725 4.464-5.195 4.86a1 1 0 0 0-.546 1.746a1.63 1.63 0 0 1 .466.908a3.06 3.06 0 0 1 .093.82v2.333c-.01.648-.01 1.133-.01 1.356a1 1 0 1 0 2 0c0-.217 0-.692.01-1.34v-2.35a4.881 4.881 0 0 0-.155-1.311a4.256 4.256 0 0 0-.116-.416a6.513 6.513 0 0 0 5.445-6.424A8.697 8.697 0 0 0 22 9.203a6.13 6.13 0 0 0-1.263-3.826Z'/%3E%3C/svg%3E");mask:var(--un-icon) no-repeat;mask-size:100% 100%;-webkit-mask:var(--un-icon) no-repeat;-webkit-mask-size:100% 100%;background-color:currentColor;display:inline-block;height:1.2em;width:1.2em;vertical-align:text-bottom}.absolute{position:absolute}.z-40{z-index:40}.m-5{margin:1.25rem}.m-auto{margin:auto}.\!-mt-2{margin-top:-.5rem!important}.mb-0{margin-bottom:0}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.mt-10{margin-top:2.5rem}.mt-8{margin-top:2rem}.inline{display:inline}.h-12{height:3rem}.w-12{width:3rem}.flex{display:flex}.flex-auto{flex:1 1 auto}.select-none{user-select:none}[fill~=none]{fill:none}[stroke-width~="\32 "]{stroke-width:2px}[stroke-width~="\34 "]{stroke-width:4px}[stroke~=black]{--un-stroke-opacity:1;stroke:rgba(0,0,0,var(--un-stroke-opacity))}.px-7{padding-left:1.75rem;padding-right:1.75rem}.py-10{padding-top:2.5rem;padding-bottom:2.5rem}.font-mono{font-family:"DM Mono",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}.font-sans{font-family:Inter,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}.text-sm{font-size:.875rem;line-height:1.25rem}.text-gray-700{--un-text-opacity:1;color:rgba(55,65,81,var(--un-text-opacity))}.no-underline{text-decoration:none}.opacity-50{opacity:.5}.hover\:opacity-75:hover{opacity:.75}.outline-none{outline:2px solid transparent;outline-offset:2px}@media (max-width:767.9px){.lt-md\:hidden{display:none}}@media (min-width:768px){.md\:hidden,[md\:hidden=""]{display:none}}@media (min-width:1024px){.lg\:fixed{position:fixed}}@media (prefers-reduced-motion){path[data-v-10f99b2b]{animation:none!important;stroke-dasharray:unset!important}}@keyframes grow-10f99b2b{0%{opacity:0}10%{opacity:1;transform:translateY(1%)}40%{transform:translate(0)}50%,to{stroke-dasharray:2000px 0}95%{opacity:1}to{opacity:0}}path[data-v-10f99b2b]{stroke-dashoffset:1px;stroke-dasharray:0 2000px;animation:grow-10f99b2b 12s ease forwards infinite;transform-origin:center;stroke:#303030;animation-delay:0s}.nav[data-v-2aa5d29f]{padding:2rem;width:100%;display:grid;grid-template-columns:auto max-content;box-sizing:border-box}.nav>[data-v-2aa5d29f]{margin:auto}.nav a[data-v-2aa5d29f]{cursor:pointer;text-decoration:none;color:inherit;transition:opacity .2s ease;opacity:.6;outline:0}.nav a[data-v-2aa5d29f]:hover{opacity:1;text-decoration-color:inherit}.nav .right[data-v-2aa5d29f]{display:grid;grid-gap:1.2rem;grid-auto-flow:column}.nav .right>[data-v-2aa5d29f]{margin:auto}</style><link rel="preload" href="/assets/index.eb3f67ee.css" as="style"><link rel="modulepreload" crossorigin="" href="/assets/vue2tovue3.65c96a15.js"><meta property="og:image" content="https://s1.imgbed.xyz/2022/09/23/kSyVq.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@XU"><meta property="og:title" content="vue2到vue3"><meta property="og:description" content="vue2到vue3"><meta name="description" content="vue2到vue3"><meta name="head:count" content="6"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/dmmono/v14/aFTU7PB1QTsUX8KYhh0.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/inter/v18/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuLyfMZg.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/inter/v18/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuGKYMZg.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="https://fonts.gstatic.com/s/inter/v18/UcCO3FwrK3iLTeHuS_nVMrMxCp50SjIw2boKoduKmMEVuDyYMZg.ttf"></head><body class="font-sans text-gray-700 dark:text-gray-200"><div id="app" data-server-rendered="true"><!--[--><header class="header z-40" data-v-2aa5d29f=""><a href="/" class="w-12 h-12 absolute lg:fixed m-5 select-none outline-none" focusable="false" data-v-2aa5d29f=""><svg viewBox="0 0 226 206" width="100" height="100" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-2aa5d29f="" data-v-10f99b2b=""><title data-v-10f99b2b="">© Bohua Xu</title><path d="M207.618 27.9436C208.818 31.8103 209.351 32.3436 209.351 30.2103C209.484 26.6103 207.351 21.9436 205.484 21.9436C204.818 21.9436 203.884 23.2769 203.351 24.877C202.951 26.477 199.751 30.6103 196.551 34.2103C189.618 41.5436 188.018 48.2103 190.684 58.7436C191.884 63.4103 191.884 66.077 190.684 69.5436C189.218 74.3436 190.951 81.9437 193.751 81.9437C197.218 81.9437 202.951 77.277 207.084 71.0103C215.751 57.9436 218.018 52.477 217.751 44.7436C217.751 38.6103 218.151 37.1436 220.951 35.0103C224.284 32.3436 225.218 28.6103 222.551 28.6103C221.751 28.6103 219.484 29.9436 217.751 31.5436L214.418 34.6103L215.218 28.6103C215.751 24.3436 216.951 22.077 219.351 20.2103C221.218 18.877 222.818 17.1436 222.818 16.477C222.818 14.2103 218.818 15.277 217.218 17.9436C215.218 21.1436 212.018 21.277 206.818 18.6103C200.951 15.5436 197.484 10.3436 198.284 5.94363C199.084 2.47697 197.484 -0.1897 195.618 1.54364C195.218 1.94363 194.818 3.8103 194.818 5.54364C194.818 8.6103 194.418 8.74363 190.551 7.67697C184.284 6.21031 156.151 6.34363 156.284 7.94363C156.284 8.74363 157.351 9.14364 158.684 9.01031C160.018 8.87698 162.151 9.81032 163.351 11.1436C165.484 13.4103 165.084 13.8103 157.218 17.4103C151.884 19.677 146.418 21.1436 142.551 21.1436C134.151 21.277 133.751 23.677 141.751 24.6103C149.751 25.5436 152.418 27.8103 148.684 30.6103C142.684 35.1436 136.551 37.277 128.951 37.277C123.884 37.277 120.818 37.8103 120.551 38.877C120.151 40.077 121.484 40.6103 124.684 40.6103C127.351 40.6103 129.484 41.277 129.484 41.9436C129.484 44.6103 120.551 48.7436 103.484 54.077C64.951 65.9436 50.4176 72.7437 39.0843 83.677C36.0176 86.7437 32.151 91.8103 30.6843 94.877C29.0843 98.3437 27.351 100.21 26.2843 99.8103C23.351 98.7437 16.551 106.744 13.4843 114.877C11.8843 119.01 9.75096 126.344 8.68429 131.144C7.61763 135.81 5.75096 141.41 4.68429 143.41C2.55096 147.677 2.28429 152.21 4.15096 152.877C4.95096 153.144 4.68429 155.944 3.35096 159.944C2.15096 163.944 1.21763 172.744 1.08429 182.077C0.817626 195.81 1.08429 197.944 3.35096 200.477C7.35096 204.877 6 188.5 6 188.5V187C6 186 9.56682 170.333 12.3668 165.667C14.5002 162.067 16.6846 158.077 17.0846 158.477C17.4846 158.744 16.9513 162.077 16.1513 165.677C14.4179 172.344 14.9513 176.61 17.4846 176.61C18.2846 176.61 18.8179 173.41 18.8179 169.144C18.8179 162.61 19.7513 159.944 25.4846 149.277C29.2179 142.477 32.1513 135.277 32.1513 133.144C32.1513 128.61 34.2846 127.01 46.1513 122.61C56.5513 118.61 70.9512 117.144 78.5512 119.144C81.6179 120.077 84.1512 121.144 84.1512 121.81C84.1512 123.944 76.5512 129.944 74.6846 129.277C71.8846 128.21 54.4179 137.144 48.8179 142.477C46.2846 145.01 44.1513 148.21 44.1513 149.677C44.1513 151.277 46.3184 155.277 48.2846 160.61C50.2508 165.944 52.818 169.41 47.618 184.077C43.8846 194.344 44.4179 199.944 49.3513 206.077L51.7513 209.144L53.618 205.81C54.9513 203.544 55.4846 197.41 55.4846 184.61V166.61L61.2179 155.944C64.4179 150.077 69.0846 142.344 71.7513 138.61C76.0179 132.877 76.6846 132.344 77.6179 134.61C79.6179 139.81 78.8179 143.144 74.0179 148.877C67.7512 156.21 64.1513 163.944 64.1513 170.21C64.1513 175.544 65.2179 179.277 66.8179 179.277C68.4179 179.277 74.6846 164.21 77.3512 154.077C79.2179 146.344 80.6846 143.81 85.0846 139.677C91.8846 133.277 93.0846 129.677 90.0179 125.01C88.4179 122.477 88.1513 121.277 89.3512 120.877C92.6846 119.81 104.018 109.944 104.818 107.41C105.618 104.61 109.618 103.144 122.818 100.61C137.751 97.8103 148.818 99.6769 159.085 106.744C164.951 110.877 167.218 116.344 165.351 121.81C164.151 125.144 163.218 125.677 157.485 126.344C153.885 126.744 148.551 128.344 145.618 129.944C139.751 132.877 134.951 139.944 137.351 142.344C139.085 144.077 151.085 138.344 158.285 132.077C161.351 129.544 166.551 126.744 169.885 125.944C183.885 122.344 185.885 114.21 176.285 99.8103L173.485 95.6769L183.751 96.3436C196.018 97.0103 201.751 99.1436 204.818 103.81C207.351 107.677 206.285 112.744 201.618 118.877L198.818 122.21L197.618 118.877C196.285 115.41 190.018 110.344 188.685 111.677C188.285 112.077 189.218 113.01 190.685 113.944C192.285 114.744 194.418 116.877 195.618 118.744C197.751 121.81 197.618 122.344 194.685 127.944C192.151 132.61 191.885 134.477 192.951 137.544C193.751 139.944 195.218 141.277 196.818 141.277C199.218 141.277 199.485 140.477 199.218 132.744C198.818 125.544 199.218 123.81 202.018 120.477C206.951 114.61 208.685 108.21 206.551 103.677C204.018 98.3436 197.218 95.6769 183.485 94.6103C174.685 93.8103 176.285 96.6103 173.485 94.6103" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-10f99b2b=""></path></svg></a><nav class="nav" data-v-2aa5d29f=""><div class="spacer" data-v-2aa5d29f=""></div><div class="right" data-v-2aa5d29f=""><a href="/posts" class="" title="Blog" data-v-2aa5d29f=""><span class="lt-md:hidden" data-v-2aa5d29f="">Blog</span><div i-ri-article-line="" md:hidden="" data-v-2aa5d29f=""></div></a><a href="/projects" class="" title="Projects" data-v-2aa5d29f=""><span class="lt-md:hidden" data-v-2aa5d29f="">Projects</span><div i-ri-lightbulb-line="" class="md:hidden" data-v-2aa5d29f=""></div></a><a href="/react" class="lt-md:hidden" title="React" data-v-2aa5d29f="">React </a><a href="/vue" class="lt-md:hidden" title="vue" data-v-2aa5d29f="">Vue </a><a href="/jottings" class="lt-md:hidden" title="jottings" data-v-2aa5d29f="">Jottings </a><a href="/wechat" class="" title="wechat" data-v-2aa5d29f=""><svg width="20" height="20" viewBox="0 0 48 48" data-v-2aa5d29f=""><g fill="none" data-v-2aa5d29f=""><path d="M36.997 21.711C36.843 13.008 29.74 6 21 6C12.163 6 5 13.163 5 22c0 4.17 1.595 7.968 4.209 10.815l-1.199 7.21l7.115-3.055c3.135 1.042 6.093 1.303 8.875.782" clip-rule="evenodd" data-v-2aa5d29f=""></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M36.997 21.711C36.843 13.008 29.74 6 21 6C12.163 6 5 13.163 5 22c0 4.17 1.595 7.968 4.209 10.815l-1.199 7.21l7.115-3.055c3.135 1.042 6.093 1.303 8.875.782" data-v-2aa5d29f=""></path><path fill="currentColor" d="M15.125 20.467a2.258 2.258 0 0 0 2.25-2.267a2.258 2.258 0 0 0-2.25-2.267a2.258 2.258 0 0 0-2.25 2.267a2.258 2.258 0 0 0 2.25 2.267Zm9 0a2.258 2.258 0 0 0 2.25-2.267a2.258 2.258 0 0 0-2.25-2.267a2.258 2.258 0 0 0-2.25 2.267a2.258 2.258 0 0 0 2.25 2.267Z" data-v-2aa5d29f=""></path><path d="M38.762 39.93A10.453 10.453 0 0 1 32.5 42C26.701 42 22 37.299 22 31.5S26.701 21 32.5 21S43 25.701 43 31.5c0 1.6-.358 3.116-.998 4.473" clip-rule="evenodd" data-v-2aa5d29f=""></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M38.762 39.93A10.453 10.453 0 0 1 32.5 42C26.701 42 22 37.299 22 31.5S26.701 21 32.5 21S43 25.701 43 31.5c0 1.6-.358 3.116-.998 4.473" data-v-2aa5d29f=""></path><path d="M42.002 35.973L43 42l-4.238-2.07" clip-rule="evenodd" data-v-2aa5d29f=""></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M42.002 35.973L43 42l-4.238-2.07" data-v-2aa5d29f=""></path><path fill="currentColor" d="M35.688 30.8A1.694 1.694 0 0 1 34 29.1c0-.939.755-1.7 1.688-1.7c.931 0 1.687.761 1.687 1.7s-.755 1.7-1.688 1.7Zm-6.75 0a1.694 1.694 0 0 1-1.688-1.7c0-.939.756-1.7 1.688-1.7c.931 0 1.687.761 1.687 1.7s-.756 1.7-1.688 1.7Z" data-v-2aa5d29f=""></path></g></svg></a><a href="https://xubohua.top/" target="_blank" title="notes" class="lt-md:hidden" data-v-2aa5d29f=""><div i-material-symbols-edit-document-outline-rounded="" data-v-2aa5d29f=""></div></a><a href="https://github.com/xubohuah" target="_blank" title="GitHub" class="lt-md:hidden" data-v-2aa5d29f=""><div i-uil-github-alt="" data-v-2aa5d29f=""></div></a><a href="https://3d.xubh.top" target="_blank" title="GitHub" class="lt-md:hidden" data-v-2aa5d29f=""><div i-bi-badge-3d="" data-v-2aa5d29f=""></div></a><a href="https://3d.xubh.top" target="_blank" title="GitHub" class="md:hidden" data-v-2aa5d29f=""><div i-bi-badge-3d="" data-v-2aa5d29f=""></div></a><a class="select-none" title="Toggle Color Scheme" data-v-2aa5d29f=""><svg style="vertical-align:sub;display:none" class="inline" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938A7.999 7.999 0 0 0 4 12z"></path></svg><svg style="vertical-align:sub" class="inline" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12a6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636L5.636 7.05L3.515 4.93zM16.95 18.364l1.414-1.414l2.121 2.121l-1.414 1.414l-2.121-2.121zm2.121-14.85l1.414 1.415l-2.121 2.121l-1.414-1.414l2.121-2.121zM5.636 16.95l1.414 1.414l-2.121 2.121l-1.414-1.414l2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></a></div></nav></header><main class="px-7 py-10"><!--[--><!----><div class="prose m-auto mb-8"><h1 class="mb-0">vue2到vue3</h1><p class="opacity-50 !-mt-2">Oct 3, 2022 <span>· 10min</span></p><!----></div><article><!--[--><div class="prose m-auto"><p></p><div class="table-of-contents"><ul><li><a href="#_1、父子组件数据传递">1、父子组件数据传递</a><ul><li><a href="#父组件数据传递到子组件">父组件数据传递到子组件</a></li><li><a href="#子组件数据传递到父组件">子组件数据传递到父组件</a></li><li><a href="#父组件使用子组件数据">父组件使用子组件数据</a></li></ul></li><li><a href="#_2、组件之间双向绑定">2、组件之间双向绑定</a></li><li><a href="#_3、路由跳转，获取路由参数">3、路由跳转，获取路由参数</a></li><li><a href="#_4、获取上下文对象">4、获取上下文对象</a></li><li><a href="#_5、插槽的使用">5、插槽的使用</a></li><li><a href="#_6、缓存路由组件">6、缓存路由组件</a></li><li><a href="#_7、逻辑复用">7、逻辑复用</a></li><li><a href="#_8、生命周期">8、生命周期</a></li><li><a href="#_9、全局-api">9、全局 API</a></li><li><a href="#_10、与-typescript-结合使用">10、与 TypeScript 结合使用</a><ul><li><a href="#为-props-标注类型">为 props 标注类型</a></li><li><a href="#为-ref-标注类型">为 ref() 标注类型</a></li><li><a href="#为-reactive-标注类型">为 reactive() 标注类型</a></li></ul></li></ul></div><p></p><h2 id="_1、父子组件数据传递" tabindex="-1">1、父子组件数据传递 <a class="header-anchor" href="#_1、父子组件数据传递" aria-hidden="true">#</a></h2><h3 id="父组件数据传递到子组件" tabindex="-1">父组件数据传递到子组件 <a class="header-anchor" href="#父组件数据传递到子组件" aria-hidden="true">#</a></h3><p>Vue3 中父组件同样是通过属性传递数据，但子组件接受数据的方式和 Vue2 不同。在 <code>&lt;script setup&gt;</code> 中，props 需要使用 <code>defineProps()</code> 这个宏函数来进行声明，它的参数和 Vue2 props 选项的值是一样的。</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">父组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">some-prop</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"parent message"</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">const props = defineProps(</span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">someProp</span><span style="color:#dbd7ca">: </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#e0a569">type</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">String</span><span style="color:#858585">,</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#e0a569">required</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">true</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">}</span><span style="color:#dbd7ca">)</span></span>
<span class="line"><span style="color:#dbd7ca">console.log(props.someProp) // parent message</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  &lt;!-- 使用 someProp 或 props.someProp --&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;{{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">someProp</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;{{</span><span style="color:#dbd7ca"> props.</span><span style="color:#b8a965">someProp</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">父组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">ChildView</span><span style="color:#393a34"> </span><span style="color:#b58451">some-prop</span><span style="color:#ab5959">=</span><span style="color:#b56959">"parent message"</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">const props = defineProps(</span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">someProp</span><span style="color:#393a34">: </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#b58451">type</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b58451">String</span><span style="color:#8e8f8b">,</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#b58451">required</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#1c6b48">true</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">}</span><span style="color:#393a34">)</span></span>
<span class="line"><span style="color:#393a34">console.log(props.someProp) // parent message</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  &lt;!-- 使用 someProp 或 props.someProp --&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;{{</span><span style="color:#393a34"> </span><span style="color:#8c862b">someProp</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;{{</span><span style="color:#393a34"> props.</span><span style="color:#8c862b">someProp</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span></code></pre></div></code></pre><p><code>defineProps</code> 、<code>defineEmits</code> 、 <code>defineExpose</code> 和 <code>withDefaults</code> 这四个宏函数只能在 <code>&lt;script setup&gt;</code> 中使用。他们不需要导入，会随着 <code>&lt;script setup&gt;</code> 的处理过程中一起被编译。</p><h3 id="子组件数据传递到父组件" tabindex="-1">子组件数据传递到父组件 <a class="header-anchor" href="#子组件数据传递到父组件" aria-hidden="true">#</a></h3><p>Vue2 中子组件数据传递到父组件，通常是使用 <code>$emit</code> 触发一个自定义事件来进行传递。但 <code>$emit</code> 无法在 <code>&lt;script setup&gt;</code> 中使用，这时候我们需要使用 <code>defineEmits()</code>：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">const emit = defineEmits(['someEvent'])</span></span>
<span class="line"><span style="color:#dbd7ca">function onClick() </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">emit</span><span style="color:#858585">(</span><span style="color:#c98a7d">'someEvent'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'child message'</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">button</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">@click="onClick"&gt;点击&lt;/button&gt;</span></span>
<span class="line"><span style="color:#fdaeb7;font-style:italic">&lt;/template&gt;</span></span>
<span class="line"><span style="color:#e0a569">复制代码</span></span>
<span class="line"><span style="color:#fdaeb7;font-style:italic">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">父组件</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">--&gt;</span></span>
<span class="line"><span style="color:#fdaeb7;font-style:italic">&lt;script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import ChildView from './ChildView.vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">function someEvent(value) </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">console</span><span style="color:#858585">.</span><span style="color:#a1b567">log</span><span style="color:#858585">(</span><span style="color:#b8a965">value</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// child message</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">@some-event="someEvent"</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">const emit = defineEmits(['someEvent'])</span></span>
<span class="line"><span style="color:#393a34">function onClick() </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">emit</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'someEvent'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#b56959">'child message'</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">button</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">@click="onClick"&gt;点击&lt;/button&gt;</span></span>
<span class="line"><span style="color:#b31d28;font-style:italic">&lt;/template&gt;</span></span>
<span class="line"><span style="color:#b58451">复制代码</span></span>
<span class="line"><span style="color:#b31d28;font-style:italic">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#b58451">父组件</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">--&gt;</span></span>
<span class="line"><span style="color:#b31d28;font-style:italic">&lt;script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import ChildView from './ChildView.vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">function someEvent(value) </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">console</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">log</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// child message</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">ChildView</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">@some-event="someEvent"</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><h3 id="父组件使用子组件数据" tabindex="-1">父组件使用子组件数据 <a class="header-anchor" href="#父组件使用子组件数据" aria-hidden="true">#</a></h3><p>在 <code>&lt;script setup&gt;</code> 中，组件的属性和方法默认都是私有的。父组件无法访问到子组件中的任何东西，除非子组件通过 <code>defineExpose</code> 显式的暴露出去：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const msg = ref('hello vue3!')</span></span>
<span class="line"><span style="color:#dbd7ca">function change() </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">msg</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'hi vue3!'</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">console</span><span style="color:#858585">.</span><span style="color:#a1b567">log</span><span style="color:#858585">(</span><span style="color:#b8a965">msg</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#dbd7ca">// 属性或方法必须暴露出去，父组件才能使用</span></span>
<span class="line"><span style="color:#dbd7ca">defineExpose(</span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">msg</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">change</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca">)</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">父组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">onMounted</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const child = ref(null)</span></span>
<span class="line"><span style="color:#dbd7ca">onMounted(() =&gt; </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">console</span><span style="color:#858585">.</span><span style="color:#a1b567">log</span><span style="color:#858585">(</span><span style="color:#b8a965">child</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#858585">.</span><span style="color:#b8a965">msg</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// hello vue3!</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">child</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#858585">.</span><span style="color:#a1b567">change</span><span style="color:#858585">()</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// hi vue3!</span></span>
<span class="line"><span style="color:#858585">}</span><span style="color:#dbd7ca">)</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">ref</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"child"</span><span style="color:#858585">&gt;&lt;/</span><span style="color:#e0a569">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const msg = ref('hello vue3!')</span></span>
<span class="line"><span style="color:#393a34">function change() </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">msg</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#b56959">'hi vue3!'</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">console</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">log</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">msg</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#393a34">// 属性或方法必须暴露出去，父组件才能使用</span></span>
<span class="line"><span style="color:#393a34">defineExpose(</span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">msg</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">change</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34">)</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">父组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">onMounted</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const child = ref(null)</span></span>
<span class="line"><span style="color:#393a34">onMounted(() =&gt; </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">console</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">log</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">child</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">msg</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// hello vue3!</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">child</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">change</span><span style="color:#8e8f8b">()</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// hi vue3!</span></span>
<span class="line"><span style="color:#8e8f8b">}</span><span style="color:#393a34">)</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">ChildView</span><span style="color:#393a34"> </span><span style="color:#b58451">ref</span><span style="color:#ab5959">=</span><span style="color:#b56959">"child"</span><span style="color:#8e8f8b">&gt;&lt;/</span><span style="color:#b58451">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><h2 id="_2、组件之间双向绑定" tabindex="-1">2、组件之间双向绑定 <a class="header-anchor" href="#_2、组件之间双向绑定" aria-hidden="true">#</a></h2><p>大家都知道 Vue2 中组件的双向绑定采用的是 <code>v-model</code> 或 <code>.snyc</code> 修饰符，两种写法多少显得有点重复，于是在 Vue3 中合成了一种。Vue3 统一使用 <code>v-model</code> 进行处理，并且可以和多个数据进行绑定，如 <code>v-model:foo</code>、<code>v-model:bar</code>。</p><pre><code><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#dbd7ca">v-model` 等价于 `:model-value="someValue"` 和 `@update:model-value="someValue = $event"</span></span>
<span class="line"><span style="color:#dbd7ca">v-model:foo` 等价于 `:foo="someValue"` 和 `@update:foo="someValue = $event"</span></span>
<span class="line"><span style="color:#dbd7ca"></span></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#393a34">v-model` 等价于 `:model-value="someValue"` 和 `@update:model-value="someValue = $event"</span></span>
<span class="line"><span style="color:#393a34">v-model:foo` 等价于 `:foo="someValue"` 和 `@update:foo="someValue = $event"</span></span>
<span class="line"><span style="color:#393a34"></span></span></code></pre></div></code></pre><p>下面就是一个父子组件之间双向绑定的例子：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">父组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const msg = ref('hello vue3!')</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-model</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"msg"</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#dbd7ca">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">@click="emit('update:modelValue',</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'hi vue3！'</span><span style="color:#fdaeb7;font-style:italic">)"&gt;{{</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">modelValue</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">}}&lt;/div&gt;</span></span>
<span class="line"><span style="color:#fdaeb7;font-style:italic">&lt;/template&gt;</span></span>
<span class="line"><span style="color:#e0a569">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">父组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import ChildView from './ChildView.vue'</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const msg = ref('hello vue3!')</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">ChildView</span><span style="color:#393a34"> </span><span style="color:#b58451">v-model</span><span style="color:#ab5959">=</span><span style="color:#b56959">"msg"</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#393a34">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">@click="emit('update:modelValue',</span><span style="color:#393a34"> </span><span style="color:#b56959">'hi vue3！'</span><span style="color:#b31d28;font-style:italic">)"&gt;{{</span><span style="color:#393a34"> </span><span style="color:#b58451">modelValue</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">}}&lt;/div&gt;</span></span>
<span class="line"><span style="color:#b31d28;font-style:italic">&lt;/template&gt;</span></span>
<span class="line"><span style="color:#b58451">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>子组件可以结合 <code>input</code> 使用：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#dbd7ca">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">input</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">:value="modelValue"</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">@input="emit('update:modelValue',</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">$event.target.value)"</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#393a34">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">input</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">:value="modelValue"</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">@input="emit('update:modelValue',</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">$event.target.value)"</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>如果你觉得上面的模板比较繁琐，也可以结合 <code>computed</code> 一起使用：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;!--</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">子组件</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">--&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">computed</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const props = defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#dbd7ca">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#dbd7ca">const newValue = computed(</span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">get</span><span style="color:#858585">()</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">    return props.</span><span style="color:#b8a965">modelValue</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">},</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">set</span><span style="color:#858585">(</span><span style="color:#b8a965">value</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#a1b567">emit</span><span style="color:#858585">(</span><span style="color:#c98a7d">'update:modelValue'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">value</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">}</span><span style="color:#dbd7ca">)</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">input</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-model</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"newValue"</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;!--</span><span style="color:#393a34"> </span><span style="color:#8c862b">子组件</span><span style="color:#393a34"> </span><span style="color:#ab5959">--&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">computed</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const props = defineProps(['modelValue'])</span></span>
<span class="line"><span style="color:#393a34">const emit = defineEmits(['update:modelValue'])</span></span>
<span class="line"><span style="color:#393a34">const newValue = computed(</span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">get</span><span style="color:#8e8f8b">()</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">    return props.</span><span style="color:#8c862b">modelValue</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">},</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">set</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#6c7834">emit</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'update:modelValue'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">value</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">}</span><span style="color:#393a34">)</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">input</span><span style="color:#393a34"> </span><span style="color:#b58451">v-model</span><span style="color:#ab5959">=</span><span style="color:#b56959">"newValue"</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><h2 id="_3、路由跳转，获取路由参数" tabindex="-1">3、路由跳转，获取路由参数 <a class="header-anchor" href="#_3、路由跳转，获取路由参数" aria-hidden="true">#</a></h2><p>在 Vue2 中我们通常是使用 <code>this.$router</code> 或 <code>this.$route</code> 来进行路由的跳转和参数获取，但在 <code>&lt;script-setup&gt;</code>中，是这些方法无法使用的。我们可以使用 <code>vue-router</code> 提供的 <code>useRouter</code> 方法，来进行路由跳转：</p><pre><code class="language-xml"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import { useRouter } from 'vue-router'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const router = useRouter()</span></span>
<span class="line"><span style="color:#dbd7ca">function onClick() {</span></span>
<span class="line"><span style="color:#dbd7ca">  router.push({</span></span>
<span class="line"><span style="color:#dbd7ca">    path: '/about',</span></span>
<span class="line"><span style="color:#dbd7ca">    query: {</span></span>
<span class="line"><span style="color:#dbd7ca">      msg: 'hello vue3!'</span></span>
<span class="line"><span style="color:#dbd7ca">    }</span></span>
<span class="line"><span style="color:#dbd7ca">  })</span></span>
<span class="line"><span style="color:#dbd7ca">}</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import { useRouter } from 'vue-router'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const router = useRouter()</span></span>
<span class="line"><span style="color:#393a34">function onClick() {</span></span>
<span class="line"><span style="color:#393a34">  router.push({</span></span>
<span class="line"><span style="color:#393a34">    path: '/about',</span></span>
<span class="line"><span style="color:#393a34">    query: {</span></span>
<span class="line"><span style="color:#393a34">      msg: 'hello vue3!'</span></span>
<span class="line"><span style="color:#393a34">    }</span></span>
<span class="line"><span style="color:#393a34">  })</span></span>
<span class="line"><span style="color:#393a34">}</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>当我们要获取路由参数时，可以使用 <code>vue-router</code> 提供的 <code>useRoute</code>方法：</p><pre><code class="language-xml"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import { useRoute } from 'vue-router'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const route = useRoute()</span></span>
<span class="line"><span style="color:#dbd7ca">console.log(route.query.msg) // hello vue3!</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import { useRoute } from 'vue-router'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const route = useRoute()</span></span>
<span class="line"><span style="color:#393a34">console.log(route.query.msg) // hello vue3!</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><h2 id="_4、获取上下文对象" tabindex="-1">4、获取上下文对象 <a class="header-anchor" href="#_4、获取上下文对象" aria-hidden="true">#</a></h2><p>Vue3 的 <code>setup</code> 中无法使用 <code>this</code> 这个上下文对象。可能刚接触 Vue3 的兄弟会有点懵，我想使用 <code>this</code> 上的属性和方法应该怎么办呢。虽然不推荐这样使用，但依然可以通过 <code>getCurrentInstance</code> 方法获取上下文对象：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">getCurrentInstance</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">// 以下两种方法都可以获取到上下文对象</span></span>
<span class="line"><span style="color:#dbd7ca">const </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ctx</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> = getCurrentInstance()</span></span>
<span class="line"><span style="color:#dbd7ca">const </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">proxy</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca">  = getCurrentInstance()</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">getCurrentInstance</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">// 以下两种方法都可以获取到上下文对象</span></span>
<span class="line"><span style="color:#393a34">const </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ctx</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> = getCurrentInstance()</span></span>
<span class="line"><span style="color:#393a34">const </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">proxy</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34">  = getCurrentInstance()</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>这样我们就可以使用 <code>$parent</code> 、<code>$refs</code> 等，干自己想干的事情了，下面是我打印出来的 <code>ctx</code> 的完整属性。</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7cb24dc592084014976392412dac0325~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?" alt="image.png"></p><p>注意：<code>ctx</code> 只能在开发环境使用，生成环境为 undefined 。 推荐使用 <code>proxy</code> ，在开发环境和生产环境都可以使用。</p><h2 id="_5、插槽的使用" tabindex="-1">5、插槽的使用 <a class="header-anchor" href="#_5、插槽的使用" aria-hidden="true">#</a></h2><p>在 Vue2 的中一般是通过 <code>slot</code> 属性指定模板的位置，通过 <code>slot-scope</code> 获取作用域插槽的数据，如：</p><pre><code class="language-html"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">&lt;!-- 父组件 --&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'./ChildView.vue'</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">parent</span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">slot</span><span style="color:#858585">=</span><span style="color:#c98a7d">"content"</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">slot-scope</span><span style="color:#858585">=</span><span style="color:#c98a7d">"{ msg }"</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">      </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">{{ msg }}</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;/</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"><span style="color:#758575">&lt;!-- 子组件 --&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">child</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">slot</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">name</span><span style="color:#858585">=</span><span style="color:#c98a7d">"content"</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">msg</span><span style="color:#858585">=</span><span style="color:#c98a7d">"hello vue3!"</span><span style="color:#858585">&gt;&lt;/</span><span style="color:#429988">slot</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">&lt;!-- 父组件 --&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8c862b">ChildView</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'./ChildView.vue'</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">parent</span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#393a34"> </span><span style="color:#b58451">slot</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"content"</span><span style="color:#393a34"> </span><span style="color:#b58451">slot-scope</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"{ msg }"</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">      </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">{{ msg }}</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;/</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"><span style="color:#a0ada0">&lt;!-- 子组件 --&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">child</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">slot</span><span style="color:#393a34"> </span><span style="color:#b58451">name</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"content"</span><span style="color:#393a34"> </span><span style="color:#b58451">msg</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"hello vue3!"</span><span style="color:#8e8f8b">&gt;&lt;/</span><span style="color:#2f8a89">slot</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>在 Vue3 中则是通过 <code>v-slot</code> 这个指令来指定模板的位置，同时获取作用域插槽的数据，如：</p><pre><code class="language-html"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">&lt;!-- 父组件 --&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ChildView</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'./ChildView.vue'</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">parent</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-slot:content</span><span style="color:#858585">=</span><span style="color:#c98a7d">"{ msg }"</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">      </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">{{ msg }}</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;/</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575">&lt;!-- ChildView 也可以简写为： --&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">#content</span><span style="color:#858585">=</span><span style="color:#c98a7d">"{ msg }"</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">{{ msg }}</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#fdaeb7;font-style:italic">ChildView</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"><span style="color:#758575">&lt;!-- 子组件 --&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">child</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">slot</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">name</span><span style="color:#858585">=</span><span style="color:#c98a7d">"content"</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">msg</span><span style="color:#858585">=</span><span style="color:#c98a7d">"hello vue3!"</span><span style="color:#858585">&gt;&lt;/</span><span style="color:#429988">slot</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">&lt;!-- 父组件 --&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8c862b">ChildView</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'./ChildView.vue'</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">parent</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#393a34"> </span><span style="color:#b58451">v-slot:content</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"{ msg }"</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">      </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">{{ msg }}</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;/</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0ada0">&lt;!-- ChildView 也可以简写为： --&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#393a34"> </span><span style="color:#b58451">#content</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"{ msg }"</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">{{ msg }}</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#b31d28;font-style:italic">ChildView</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"><span style="color:#a0ada0">&lt;!-- 子组件 --&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">child</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">slot</span><span style="color:#393a34"> </span><span style="color:#b58451">name</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"content"</span><span style="color:#393a34"> </span><span style="color:#b58451">msg</span><span style="color:#8e8f8b">=</span><span style="color:#b56959">"hello vue3!"</span><span style="color:#8e8f8b">&gt;&lt;/</span><span style="color:#2f8a89">slot</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>注意：<code>v-slot</code> 在 Vue2 中也可以使用，但必须是 Vue2.6+ 的版本。</p><h2 id="_6、缓存路由组件" tabindex="-1">6、缓存路由组件 <a class="header-anchor" href="#_6、缓存路由组件" aria-hidden="true">#</a></h2><p>缓存一般的动态组件，Vue3 和 Vue2 的用法是一样的，都是使用 <code>KeepAlive</code> 包裹 <code>Component</code>。但缓存路由组件，Vue3 需要结合插槽一起使用：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">// Vue2 中缓存路由组件</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#e0a569">KeepAlive</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">RouterView</span><span style="color:#dbd7ca"> </span><span style="color:#858585">/&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#e0a569">KeepAlive</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"><span style="color:#758575">// Vue3 中缓存路由组件</span></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#e0a569">RouterView</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-slot</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"{ Component }"</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">KeepAlive</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">&lt;</span><span style="color:#e0a569">Component</span><span style="color:#dbd7ca"> </span><span style="color:#fdaeb7;font-style:italic">:is="Component"&gt;&lt;/Component&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#fdaeb7;font-style:italic">&lt;/KeepAlive&gt;</span></span>
<span class="line"><span style="color:#fdaeb7;font-style:italic">&lt;/RouterView&gt;</span></span>
<span class="line"><span style="color:#e0a569">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">// Vue2 中缓存路由组件</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">KeepAlive</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">RouterView</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">/&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#b58451">KeepAlive</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"><span style="color:#a0ada0">// Vue3 中缓存路由组件</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">RouterView</span><span style="color:#393a34"> </span><span style="color:#b58451">v-slot</span><span style="color:#ab5959">=</span><span style="color:#b56959">"{ Component }"</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">KeepAlive</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">Component</span><span style="color:#393a34"> </span><span style="color:#b31d28;font-style:italic">:is="Component"&gt;&lt;/Component&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#b31d28;font-style:italic">&lt;/KeepAlive&gt;</span></span>
<span class="line"><span style="color:#b31d28;font-style:italic">&lt;/RouterView&gt;</span></span>
<span class="line"><span style="color:#b58451">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>一个持续存在的组件可以通过 <code>onActivated()</code> 和 <code>onDeactivated()</code> 两个生命周期钩子注入相应的逻辑：</p><pre><code class="language-xml"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import { onActivated, onDeactivated } from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">onActivated(() =&gt; {</span></span>
<span class="line"><span style="color:#dbd7ca">  // 调用时机为首次挂载</span></span>
<span class="line"><span style="color:#dbd7ca">  // 以及每次从缓存中被重新插入时</span></span>
<span class="line"><span style="color:#dbd7ca">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">onDeactivated(() =&gt; {</span></span>
<span class="line"><span style="color:#dbd7ca">  // 调用时机为从 DOM 上移除、进入缓存</span></span>
<span class="line"><span style="color:#dbd7ca">  // 以及组件卸载时</span></span>
<span class="line"><span style="color:#dbd7ca">})</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import { onActivated, onDeactivated } from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">onActivated(() =&gt; {</span></span>
<span class="line"><span style="color:#393a34">  // 调用时机为首次挂载</span></span>
<span class="line"><span style="color:#393a34">  // 以及每次从缓存中被重新插入时</span></span>
<span class="line"><span style="color:#393a34">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">onDeactivated(() =&gt; {</span></span>
<span class="line"><span style="color:#393a34">  // 调用时机为从 DOM 上移除、进入缓存</span></span>
<span class="line"><span style="color:#393a34">  // 以及组件卸载时</span></span>
<span class="line"><span style="color:#393a34">})</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><h2 id="_7、逻辑复用" tabindex="-1">7、逻辑复用 <a class="header-anchor" href="#_7、逻辑复用" aria-hidden="true">#</a></h2><p>Vue2 中逻辑复用主要是采用 <code>mixin</code>，但 <code>mixin</code> 会使数据来源不明，同时会引起命名冲突。所以 Vue3 更推荐的是全新的 <code>Composition Api</code>。</p><p>下面是鼠标跟踪的例子，我们可以把逻辑提取出来：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">// mouse.js</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">onMounted</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">onUnmounted</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575">// 按照惯例，组合式函数名以 use 开头</span></span>
<span class="line"><span style="color:#4d9375">export</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">function</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">useMouse</span><span style="color:#858585">()</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#858585">  </span><span style="color:#758575">// 组合式函数管理的数据</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">x</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#6394bf">0</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">y</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#6394bf">0</span><span style="color:#858585">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#cb7676">function</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">update</span><span style="color:#858585">(</span><span style="color:#b8a965">event</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#b8a965">x</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">event</span><span style="color:#858585">.</span><span style="color:#b8a965">pageX</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#b8a965">y</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">event</span><span style="color:#858585">.</span><span style="color:#b8a965">pageY</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">  </span><span style="color:#758575">// 组合式函数可以挂靠在所属组件的生命周期上，来启动和卸载副作用</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">onMounted</span><span style="color:#858585">(()</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">window</span><span style="color:#858585">.</span><span style="color:#a1b567">addEventListener</span><span style="color:#858585">(</span><span style="color:#c98a7d">'mousemove'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">update</span><span style="color:#858585">))</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">onUnmounted</span><span style="color:#858585">(()</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">window</span><span style="color:#858585">.</span><span style="color:#a1b567">removeEventListener</span><span style="color:#858585">(</span><span style="color:#c98a7d">'mousemove'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">update</span><span style="color:#858585">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">  </span><span style="color:#758575">// 通过返回值暴露所管理的数据</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#4d9375">return</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">x</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">y</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">// mouse.js</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">onMounted</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">onUnmounted</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0ada0">// 按照惯例，组合式函数名以 use 开头</span></span>
<span class="line"><span style="color:#1c6b48">export</span><span style="color:#393a34"> </span><span style="color:#ab5959">function</span><span style="color:#393a34"> </span><span style="color:#6c7834">useMouse</span><span style="color:#8e8f8b">()</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#8e8f8b">  </span><span style="color:#a0ada0">// 组合式函数管理的数据</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">x</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#296aa3">0</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">y</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#296aa3">0</span><span style="color:#8e8f8b">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#ab5959">function</span><span style="color:#393a34"> </span><span style="color:#6c7834">update</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">event</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8c862b">x</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#8c862b">event</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">pageX</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8c862b">y</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#8c862b">event</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">pageY</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">  </span><span style="color:#a0ada0">// 组合式函数可以挂靠在所属组件的生命周期上，来启动和卸载副作用</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">onMounted</span><span style="color:#8e8f8b">(()</span><span style="color:#393a34"> </span><span style="color:#ab5959">=&gt;</span><span style="color:#393a34"> </span><span style="color:#8c862b">window</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">addEventListener</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'mousemove'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">update</span><span style="color:#8e8f8b">))</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">onUnmounted</span><span style="color:#8e8f8b">(()</span><span style="color:#393a34"> </span><span style="color:#ab5959">=&gt;</span><span style="color:#393a34"> </span><span style="color:#8c862b">window</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">removeEventListener</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'mousemove'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">update</span><span style="color:#8e8f8b">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">  </span><span style="color:#a0ada0">// 通过返回值暴露所管理的数据</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#1c6b48">return</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">x</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">y</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>这时候在组件中我们就可以直接使用 <code>mouse.js</code> 暴露的数据了。</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">useMouse</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from './mouse.js'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">x</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">y</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> = useMouse()</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">Mouse position is at: </span><span style="color:#858585">{{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">x</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}</span><span style="color:#dbd7ca">, </span><span style="color:#858585">{{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">y</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">useMouse</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from './mouse.js'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">x</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">y</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> = useMouse()</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">Mouse position is at: </span><span style="color:#8e8f8b">{{</span><span style="color:#393a34"> </span><span style="color:#8c862b">x</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}</span><span style="color:#393a34">, </span><span style="color:#8e8f8b">{{</span><span style="color:#393a34"> </span><span style="color:#8c862b">y</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>我们还可以在一个组件中引入多个组合式函数，或者在一个组合式函数中引入其他的组合式函数，这个比较简单，我就不演示了。接下来，我们看看使用异步方法的组合式函数。</p><p>在做异步数据请求时，我们通常需要处理三个不同的状态：加载中、加载成功和加载失败。获取这些状态的逻辑是通用的，我们可以把它提取出来：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">// request.js</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4d9375">export</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">function</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">useRequest</span><span style="color:#858585">(</span><span style="color:#b8a965">url</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">data</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#d4976c">null</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">error</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#d4976c">null</span><span style="color:#858585">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">axios</span><span style="color:#858585">.</span><span style="color:#a1b567">get</span><span style="color:#858585">(</span><span style="color:#b8a965">url</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">.</span><span style="color:#a1b567">then</span><span style="color:#858585">((</span><span style="color:#b8a965">res</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#858585">(</span><span style="color:#b8a965">data</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">res</span><span style="color:#858585">.</span><span style="color:#b8a965">data</span><span style="color:#858585">))</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#858585">.</span><span style="color:#a1b567">catch</span><span style="color:#858585">((</span><span style="color:#b8a965">err</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#858585">(</span><span style="color:#b8a965">error</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">err</span><span style="color:#858585">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#4d9375">return</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">data</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">error</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">// request.js</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1c6b48">export</span><span style="color:#393a34"> </span><span style="color:#ab5959">function</span><span style="color:#393a34"> </span><span style="color:#6c7834">useRequest</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">url</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">data</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#a65e2b">null</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">error</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#a65e2b">null</span><span style="color:#8e8f8b">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">axios</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">get</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">url</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">then</span><span style="color:#8e8f8b">((</span><span style="color:#8c862b">res</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#ab5959">=&gt;</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">data</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#8c862b">res</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">data</span><span style="color:#8e8f8b">))</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">catch</span><span style="color:#8e8f8b">((</span><span style="color:#8c862b">err</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#ab5959">=&gt;</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">error</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#8c862b">err</span><span style="color:#8e8f8b">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#1c6b48">return</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">data</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">error</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>现在我们在组件中只需要：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">useRequest</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from './request.js'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">data</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">error</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> = useRequest('http://...')</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-if</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"data"</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">Data is: </span><span style="color:#858585">{{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">data</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-else-if</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"error"</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">Error message is: </span><span style="color:#858585">{{</span><span style="color:#dbd7ca"> error.</span><span style="color:#b8a965">message</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}}&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">&lt;</span><span style="color:#429988">div</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">v-else</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca">Loading...</span><span style="color:#858585">&lt;/</span><span style="color:#429988">div</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">template</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">useRequest</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from './request.js'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">data</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">error</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> = useRequest('http://...')</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#393a34"> </span><span style="color:#b58451">v-if</span><span style="color:#ab5959">=</span><span style="color:#b56959">"data"</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">Data is: </span><span style="color:#8e8f8b">{{</span><span style="color:#393a34"> </span><span style="color:#8c862b">data</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#393a34"> </span><span style="color:#b58451">v-else-if</span><span style="color:#ab5959">=</span><span style="color:#b56959">"error"</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">Error message is: </span><span style="color:#8e8f8b">{{</span><span style="color:#393a34"> error.</span><span style="color:#8c862b">message</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}}&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">div</span><span style="color:#393a34"> </span><span style="color:#b58451">v-else</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34">Loading...</span><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">div</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">template</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>任何组件都可以使用上面这个逻辑，这就是逻辑复用。是不是可以节省很多重复的代码，感觉摸鱼时间又要增加了~</p><h2 id="_8、生命周期" tabindex="-1">8、生命周期 <a class="header-anchor" href="#_8、生命周期" aria-hidden="true">#</a></h2><p>Vue3 的生命周期和 Vue2 相比，有以下改动：</p><ul><li><p><code>Vue3</code> 生命周期钩子都以 <code>on</code> 开头，并且需要在组件中手动导入。</p><pre><code class="language-xml"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import { onMounted } from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">onMounted(() =&gt; {</span></span>
<span class="line"><span style="color:#dbd7ca">  console.log('onMounted')</span></span>
<span class="line"><span style="color:#dbd7ca">})</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import { onMounted } from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">onMounted(() =&gt; {</span></span>
<span class="line"><span style="color:#393a34">  console.log('onMounted')</span></span>
<span class="line"><span style="color:#393a34">})</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li><li><p>Vue3 取消了 <code>beforeCreate</code> 和 <code>created</code> 钩子。如果需要在组件创建前注入逻辑，直接在 <code>&lt;script setup&gt;</code> 中编写同步代码就可以了。如果这几个钩子同时存在，<code>setup</code> 的执行顺序要优先于 <code>beforeCreate</code> 和 <code>created</code>。</p></li><li><p>Vue3 中组件卸载的钩子名称有变化，<code>beforeDestroy</code> 改为 <code>onBeforeUnmount</code>，<code>destroyed</code> 改为 <code>onUnmounted</code>。</p></li></ul><h2 id="_9、全局-api" tabindex="-1">9、全局 API <a class="header-anchor" href="#_9、全局-api" aria-hidden="true">#</a></h2><p>Vue2 中的全局属性或全局方法，是在构造函数 Vue 的原型对象上进行添加，如：<code>Vue.prototype.$axios = axios</code> 。但在 Vue3 中，需要在 <code>app</code> 实例上添加：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">// main.js</span></span>
<span class="line"><span style="color:#b8a965">app</span><span style="color:#858585">.</span><span style="color:#b8a965">config</span><span style="color:#858585">.</span><span style="color:#b8a965">globalProperties</span><span style="color:#858585">.</span><span style="color:#b8a965">$axios</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">axios</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">// main.js</span></span>
<span class="line"><span style="color:#8c862b">app</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">config</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">globalProperties</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">$axios</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#8c862b">axios</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>在组件中使用：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#858585">&lt;</span><span style="color:#429988">script</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">setup</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#dbd7ca">import </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">getCurrentInstance</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#dbd7ca">const </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">proxy</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> = getCurrentInstance()</span></span>
<span class="line"><span style="color:#dbd7ca">proxy.$axios.get('http://...')</span></span>
<span class="line"><span style="color:#858585">&lt;/</span><span style="color:#429988">script</span><span style="color:#858585">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#8e8f8b">&lt;</span><span style="color:#2f8a89">script</span><span style="color:#393a34"> </span><span style="color:#b58451">setup</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#393a34">import </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">getCurrentInstance</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> from 'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393a34">const </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">proxy</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> = getCurrentInstance()</span></span>
<span class="line"><span style="color:#393a34">proxy.$axios.get('http://...')</span></span>
<span class="line"><span style="color:#8e8f8b">&lt;/</span><span style="color:#2f8a89">script</span><span style="color:#8e8f8b">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>Vue3 中其他的全局 API，如 <code>directive</code> 、<code>component</code> 等，跟 Vue2 的用法都差不多，只不过一个是在 Vue 上调用，一个是在 <code>app</code> 实例上调用：</p><pre><code class="language-js"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#758575">// main.js</span></span>
<span class="line"><span style="color:#758575">// 全局自定义指令</span></span>
<span class="line"><span style="color:#b8a965">app</span><span style="color:#858585">.</span><span style="color:#a1b567">directive</span><span style="color:#858585">(</span><span style="color:#c98a7d">'focus'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">mounted</span><span style="color:#858585">(</span><span style="color:#b8a965">el</span><span style="color:#858585">)</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">    </span><span style="color:#b8a965">el</span><span style="color:#858585">.</span><span style="color:#a1b567">focus</span><span style="color:#858585">()</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#858585">}</span></span>
<span class="line"><span style="color:#858585">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575">// 全局自定义组件</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">CustomComp</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'./components/CustomComp.vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#b8a965">app</span><span style="color:#858585">.</span><span style="color:#a1b567">component</span><span style="color:#858585">(</span><span style="color:#c98a7d">'CustomComp'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">CustomComp</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#a0ada0">// main.js</span></span>
<span class="line"><span style="color:#a0ada0">// 全局自定义指令</span></span>
<span class="line"><span style="color:#8c862b">app</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">directive</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'focus'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">mounted</span><span style="color:#8e8f8b">(</span><span style="color:#8c862b">el</span><span style="color:#8e8f8b">)</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">    </span><span style="color:#8c862b">el</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">focus</span><span style="color:#8e8f8b">()</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8e8f8b">}</span></span>
<span class="line"><span style="color:#8e8f8b">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#a0ada0">// 全局自定义组件</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8c862b">CustomComp</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'./components/CustomComp.vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8c862b">app</span><span style="color:#8e8f8b">.</span><span style="color:#6c7834">component</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'CustomComp'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#8c862b">CustomComp</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>需要注意的是，Vue3 废弃了 <code>filter</code> 这个方法，因为通过函数或 <code>computed</code> 可以实现一样的功能。</p><h2 id="_10、与-typescript-结合使用" tabindex="-1">10、与 TypeScript 结合使用 <a class="header-anchor" href="#_10、与-typescript-结合使用" aria-hidden="true">#</a></h2><p>与 <code>TypeScript</code> 结合使用，我们只需要在 <code>&lt;script setup&gt;</code> 中添加 <code>lang="ts"</code> 就可以了。下面是一些和 <code>TypeScript</code> 结合使用的例子。</p><h3 id="为-props-标注类型" tabindex="-1">为 props 标注类型 <a class="header-anchor" href="#为-props-标注类型" aria-hidden="true">#</a></h3><ul><li><p>运行时声明。当使用 <code>&lt;script setup&gt;</code> 时，<code>defineProps()</code> 宏函数支持从它的参数中推导类型：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;</span><span style="color:#b8a965">script</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">setup</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">lang</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"ts"</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">props</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">defineProps</span><span style="color:#858585">({</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#e0a569">foo</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">type</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">String</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">required</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">true</span><span style="color:#dbd7ca"> </span><span style="color:#858585">},</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#e0a569">bar</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">Number</span></span>
<span class="line"><span style="color:#858585">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#b8a965">props</span><span style="color:#858585">.</span><span style="color:#b8a965">foo</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// string</span></span>
<span class="line"><span style="color:#b8a965">props</span><span style="color:#858585">.</span><span style="color:#b8a965">bar</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// number | undefined</span></span>
<span class="line"><span style="color:#cb7676">&lt;/</span><span style="color:#b8a965">script</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;</span><span style="color:#8c862b">script</span><span style="color:#393a34"> </span><span style="color:#8c862b">setup</span><span style="color:#393a34"> </span><span style="color:#8c862b">lang</span><span style="color:#ab5959">=</span><span style="color:#b56959">"ts"</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">props</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">defineProps</span><span style="color:#8e8f8b">({</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#b58451">foo</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#b58451">type</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b58451">String</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#b58451">required</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#1c6b48">true</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">},</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#b58451">bar</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b58451">Number</span></span>
<span class="line"><span style="color:#8e8f8b">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8c862b">props</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">foo</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// string</span></span>
<span class="line"><span style="color:#8c862b">props</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">bar</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// number | undefined</span></span>
<span class="line"><span style="color:#ab5959">&lt;/</span><span style="color:#8c862b">script</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>这被称为 <code>运行时声明</code> ，因为传递给 <code>defineProps()</code> 的参数会作为运行时的 props 选项使用。</p></li><li><p>基于类型的声明。我们还可以通过泛型参数来定义 props 的类型，这种方式更加常用：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;</span><span style="color:#b8a965">script</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">setup</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">lang</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"ts"</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#cb7676">interface</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">Props</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">foo</span><span style="color:#cb7676">:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">string</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">bar</span><span style="color:#cb7676">?:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">number</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">props</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">defineProps</span><span style="color:#858585">&lt;</span><span style="color:#a1b567">Props</span><span style="color:#858585">&gt;()</span></span>
<span class="line"><span style="color:#cb7676">&lt;/</span><span style="color:#b8a965">script</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;</span><span style="color:#8c862b">script</span><span style="color:#393a34"> </span><span style="color:#8c862b">setup</span><span style="color:#393a34"> </span><span style="color:#8c862b">lang</span><span style="color:#ab5959">=</span><span style="color:#b56959">"ts"</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#ab5959">interface</span><span style="color:#393a34"> </span><span style="color:#6c7834">Props</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">foo</span><span style="color:#ab5959">:</span><span style="color:#393a34"> </span><span style="color:#b58451">string</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">bar</span><span style="color:#ab5959">?:</span><span style="color:#393a34"> </span><span style="color:#b58451">number</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">props</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">defineProps</span><span style="color:#8e8f8b">&lt;</span><span style="color:#6c7834">Props</span><span style="color:#8e8f8b">&gt;()</span></span>
<span class="line"><span style="color:#ab5959">&lt;/</span><span style="color:#8c862b">script</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre><p>这被称为 <code>基于类型的声明</code> ，编译器会尽可能地尝试根据类型参数推导出等价的运行时选项。这种方式的不足之处在于，失去了定义 props 默认值的能力。为了解决这个问题，我们可以使用 <code>withDefaults</code> 宏函数：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">&lt;</span><span style="color:#b8a965">script</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">setup</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">lang</span><span style="color:#cb7676">=</span><span style="color:#c98a7d">"ts"</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#cb7676">interface</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">Props</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">msg</span><span style="color:#cb7676">?:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">string</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">labels</span><span style="color:#cb7676">?:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">string</span><span style="color:#858585">[]</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">props</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">withDefaults</span><span style="color:#858585">(</span><span style="color:#a1b567">defineProps</span><span style="color:#858585">&lt;</span><span style="color:#a1b567">Props</span><span style="color:#858585">&gt;(),</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#e0a569">msg</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'hello vue3!'</span><span style="color:#858585">,</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#a1b567">labels</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#858585">()</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#858585">[</span><span style="color:#c98a7d">'one'</span><span style="color:#858585">,</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'two'</span><span style="color:#858585">]</span></span>
<span class="line"><span style="color:#858585">})</span></span>
<span class="line"><span style="color:#cb7676">&lt;/</span><span style="color:#b8a965">script</span><span style="color:#cb7676">&gt;</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">&lt;</span><span style="color:#8c862b">script</span><span style="color:#393a34"> </span><span style="color:#8c862b">setup</span><span style="color:#393a34"> </span><span style="color:#8c862b">lang</span><span style="color:#ab5959">=</span><span style="color:#b56959">"ts"</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#ab5959">interface</span><span style="color:#393a34"> </span><span style="color:#6c7834">Props</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">msg</span><span style="color:#ab5959">?:</span><span style="color:#393a34"> </span><span style="color:#b58451">string</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">labels</span><span style="color:#ab5959">?:</span><span style="color:#393a34"> </span><span style="color:#b58451">string</span><span style="color:#8e8f8b">[]</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">props</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">withDefaults</span><span style="color:#8e8f8b">(</span><span style="color:#6c7834">defineProps</span><span style="color:#8e8f8b">&lt;</span><span style="color:#6c7834">Props</span><span style="color:#8e8f8b">&gt;(),</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#b58451">msg</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b56959">'hello vue3!'</span><span style="color:#8e8f8b">,</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#6c7834">labels</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">()</span><span style="color:#393a34"> </span><span style="color:#ab5959">=&gt;</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">[</span><span style="color:#b56959">'one'</span><span style="color:#8e8f8b">,</span><span style="color:#393a34"> </span><span style="color:#b56959">'two'</span><span style="color:#8e8f8b">]</span></span>
<span class="line"><span style="color:#8e8f8b">})</span></span>
<span class="line"><span style="color:#ab5959">&lt;/</span><span style="color:#8c862b">script</span><span style="color:#ab5959">&gt;</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li></ul><h3 id="为-ref-标注类型" tabindex="-1">为 ref() 标注类型 <a class="header-anchor" href="#为-ref-标注类型" aria-hidden="true">#</a></h3><ul><li><p>默认推导类型。ref 会根据初始化时的值自动推导其类型：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">year</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#6394bf">2022</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#b8a965">year</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'2022'</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// TS Error: 不能将类型 string 分配给类型 number</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">year</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#296aa3">2022</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8c862b">year</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#b56959">'2022'</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// TS Error: 不能将类型 string 分配给类型 number</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li><li><p>通过接口指定类型。有时我们可能想为 ref 内的值指定一个更复杂的类型，可以使用 <code>Ref</code> 这个接口：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">type</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">Ref</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">year</span><span style="color:#cb7676">:</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">Ref</span><span style="color:#858585">&lt;</span><span style="color:#e0a569">string</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">|</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">number</span><span style="color:#858585">&gt;</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">(</span><span style="color:#c98a7d">'2022'</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#b8a965">year</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#6394bf">2022</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// 成功！</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#1c6b48">type</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">Ref</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">year</span><span style="color:#ab5959">:</span><span style="color:#393a34"> </span><span style="color:#6c7834">Ref</span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">string</span><span style="color:#393a34"> </span><span style="color:#ab5959">|</span><span style="color:#393a34"> </span><span style="color:#b58451">number</span><span style="color:#8e8f8b">&gt;</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">(</span><span style="color:#b56959">'2022'</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8c862b">year</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#296aa3">2022</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// 成功！</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li><li><p>通过泛型指定类型。我们也可以在调用 <code>ref()</code> 时传入一个泛型参数，来覆盖默认的推导行为：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">year</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">ref</span><span style="color:#858585">&lt;</span><span style="color:#e0a569">string</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">|</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">number</span><span style="color:#858585">&gt;(</span><span style="color:#c98a7d">'2022'</span><span style="color:#858585">)</span></span>
<span class="line"><span style="color:#b8a965">year</span><span style="color:#858585">.</span><span style="color:#b8a965">value</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#6394bf">2022</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// 成功！</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">year</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">ref</span><span style="color:#8e8f8b">&lt;</span><span style="color:#b58451">string</span><span style="color:#393a34"> </span><span style="color:#ab5959">|</span><span style="color:#393a34"> </span><span style="color:#b58451">number</span><span style="color:#8e8f8b">&gt;(</span><span style="color:#b56959">'2022'</span><span style="color:#8e8f8b">)</span></span>
<span class="line"><span style="color:#8c862b">year</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">value</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#296aa3">2022</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// 成功！</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li></ul><h3 id="为-reactive-标注类型" tabindex="-1">为 reactive() 标注类型 <a class="header-anchor" href="#为-reactive-标注类型" aria-hidden="true">#</a></h3><ul><li><p>默认推导类型。<code>reactive()</code> 也会隐式地从它的参数中推导类型：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">reactive</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">book</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">reactive</span><span style="color:#858585">({</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">title</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'Vue 3 指引'</span><span style="color:#dbd7ca"> </span><span style="color:#858585">})</span></span>
<span class="line"><span style="color:#b8a965">book</span><span style="color:#858585">.</span><span style="color:#b8a965">year</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#6394bf">2022</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// TS Error: 类型 { title: string; } 上不存在属性 year</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">reactive</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">book</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">reactive</span><span style="color:#8e8f8b">({</span><span style="color:#393a34"> </span><span style="color:#b58451">title</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b56959">'Vue 3 指引'</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">})</span></span>
<span class="line"><span style="color:#8c862b">book</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">year</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#296aa3">2022</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// TS Error: 类型 { title: string; } 上不存在属性 year</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li><li><p>通过接口指定类型。要显式地指定一个 <code>reactive</code> 变量的类型，我们可以使用接口：</p><pre><code class="language-ts"><div class="shiki-container"><pre class="shiki shiki-dark" style="background-color:#121212"><code v-pre=""><span class="line"><span style="color:#4d9375">import</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span><span style="color:#dbd7ca"> </span><span style="color:#b8a965">reactive</span><span style="color:#dbd7ca"> </span><span style="color:#858585">}</span><span style="color:#dbd7ca"> </span><span style="color:#4d9375">from</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">interface</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">Book</span><span style="color:#dbd7ca"> </span><span style="color:#858585">{</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">title</span><span style="color:#cb7676">:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">string</span></span>
<span class="line"><span style="color:#dbd7ca">  </span><span style="color:#b8a965">year</span><span style="color:#cb7676">?:</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">number</span></span>
<span class="line"><span style="color:#858585">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#cb7676">const</span><span style="color:#dbd7ca"> </span><span style="color:#d4976c">book</span><span style="color:#cb7676">:</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">Book</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#a1b567">reactive</span><span style="color:#858585">({</span><span style="color:#dbd7ca"> </span><span style="color:#e0a569">title</span><span style="color:#858585">:</span><span style="color:#dbd7ca"> </span><span style="color:#c98a7d">'Vue 3 指引'</span><span style="color:#dbd7ca"> </span><span style="color:#858585">})</span></span>
<span class="line"><span style="color:#b8a965">book</span><span style="color:#858585">.</span><span style="color:#b8a965">year</span><span style="color:#dbd7ca"> </span><span style="color:#cb7676">=</span><span style="color:#dbd7ca"> </span><span style="color:#6394bf">2022</span><span style="color:#dbd7ca"> </span><span style="color:#758575">// 成功！</span></span>
<span class="line"><span style="color:#b8a965">复制代码</span></span>
<span class="line"></span></code></pre><pre class="shiki shiki-light" style="background-color:#fff"><code v-pre=""><span class="line"><span style="color:#1c6b48">import</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span><span style="color:#393a34"> </span><span style="color:#8c862b">reactive</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">}</span><span style="color:#393a34"> </span><span style="color:#1c6b48">from</span><span style="color:#393a34"> </span><span style="color:#b56959">'vue'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">interface</span><span style="color:#393a34"> </span><span style="color:#6c7834">Book</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">{</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">title</span><span style="color:#ab5959">:</span><span style="color:#393a34"> </span><span style="color:#b58451">string</span></span>
<span class="line"><span style="color:#393a34">  </span><span style="color:#8c862b">year</span><span style="color:#ab5959">?:</span><span style="color:#393a34"> </span><span style="color:#b58451">number</span></span>
<span class="line"><span style="color:#8e8f8b">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ab5959">const</span><span style="color:#393a34"> </span><span style="color:#a65e2b">book</span><span style="color:#ab5959">:</span><span style="color:#393a34"> </span><span style="color:#6c7834">Book</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#6c7834">reactive</span><span style="color:#8e8f8b">({</span><span style="color:#393a34"> </span><span style="color:#b58451">title</span><span style="color:#8e8f8b">:</span><span style="color:#393a34"> </span><span style="color:#b56959">'Vue 3 指引'</span><span style="color:#393a34"> </span><span style="color:#8e8f8b">})</span></span>
<span class="line"><span style="color:#8c862b">book</span><span style="color:#8e8f8b">.</span><span style="color:#8c862b">year</span><span style="color:#393a34"> </span><span style="color:#ab5959">=</span><span style="color:#393a34"> </span><span style="color:#296aa3">2022</span><span style="color:#393a34"> </span><span style="color:#a0ada0">// 成功！</span></span>
<span class="line"><span style="color:#8c862b">复制代码</span></span>
<span class="line"></span></code></pre></div></code></pre></li></ul><p>其他 API 与 <code>TypeScript</code> 结合使用的方法和上面大同小异，这里我就不一一列举了。具体可以参考这篇文章：<a href="https://juejin.cn/post/7129130323148800031" target="_blank" rel="noopener">如何为 Vue3 组件标注 TS 类型，看这个就够了！</a>。</p><p>转载自<a href="https://juejin.cn/search?utm_source=infinitynewtab.com&amp;query=vue&amp;type=0" target="_blank" rel="noopener">掘金vue2过度到vue3</a></p></div><!--]--></article><div class="prose m-auto mt-8 mb-8"><br><a href="/posts" class="font-mono no-underline opacity-50 hover:opacity-75">exit ..</a></div><!--]--><div class="mt-10 mb-6 prose m-auto opacity-50 flex"><span class="text-sm"><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="color:inherit">CC BY-NC-SA 4.0</a> 2021-PRESENT © Bohua Xu</span><div class="flex-auto"></div></div></main><!--]--></div><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><link rel="stylesheet" href="/assets/index.eb3f67ee.css"></body></html>