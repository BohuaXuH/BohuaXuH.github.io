import{u as a,c,w as t,_ as r,o as p,a as s,d as l}from"./app-35460d65.js";const y=s("div",{class:"prose m-auto"},[s("p",null,[s("div",{class:"table-of-contents"},[s("ul",null,[s("li",null,[s("a",{href:"#函数组件实现-memoization"},"函数组件实现 Memoization ")]),s("li",null,[s("a",{href:"#类组件实现-memoization"},"类组件实现 Memoization ")]),s("li",null,[s("a",{href:"#react-memo-存在的问题（使用usememo也可以处理）"},"React.memo() 存在的问题（使用useMemo也可以处理） ")]),s("li",null,[s("a",{href:"#usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）"},"useCallback是uesMemo的一个语法糖（更好的处理函数_直接写） ")]),s("li",null,[s("a",{href:"#通过-usecallback-来避免更多的重复渲染"},"通过 useCallback() 来避免更多的重复渲染 ")]),s("li",null,[s("a",{href:"#值得注意的事"},"值得注意的事 ")]),s("li",null,[s("a",{href:"#总结"},"总结 ")]),s("li",null,[s("a",{href:"#斐波那契数列-缓存"},"斐波那契数列 缓存 ")])])]),l(" 在 React 应用的上下文中，Memoization 是一种手段，每当父组件重新渲染时，子组件仅在它所依赖的 props 发生变化时才会重新渲染。如果子组件所依赖的 props 中没有更改，则它不会执行 render 方法，并将返回缓存的结果。由于渲染方法未执行，因此不会有虚拟 DOM 创建和差异检查，从而实现性能的提升。")]),s("p",null,"现在，让我们看看如何在类和函数组件中实现 Memoization，以避免这种不必要的重新渲染。"),s("h2",{id:"函数组件实现-memoization",tabindex:"-1"},[l("函数组件实现 Memoization "),s("a",{class:"header-anchor",href:"#函数组件实现-memoization","aria-hidden":"true"},"#")]),s("p",null,[l("为了在函数组件中实现 Memoization，我们将使用 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-api.html%23reactmemo",target:"_blank",rel:"noopener"},"React.memo()"),l("。"),s("code",null,"React.memo()"),l(" 是一个"),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.sitepoint.com%2Freact-higher-order-components%2F",target:"_blank",rel:"noopener"},"高阶组件"),l("（HOC），它执行与 "),s("code",null,"PureComponent"),l(" 类似的工作，来避免不必要的重新渲染。")]),s("p",null,"以下是函数组件的代码："),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#758575"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"function"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"Child"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"props"),s("span",{style:{color:"#858585"}},")"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"Child render"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#4D9375"}},"return"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">{"),s("span",{style:{color:"#B8A965"}},"props"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#B8A965"}},"name"),s("span",{style:{color:"#858585"}},"}</"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#4D9375"}},"default"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#B8A965"}},"React"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"memo"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"Child"),s("span",{style:{color:"#858585"}},");"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#758575"}},"// 这里我们给子组件添加 HOC 实现 Memoization")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#A0ADA0"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"function"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"Child"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"props"),s("span",{style:{color:"#8E8F8B"}},")"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"Child render"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#1C6B48"}},"return"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">{"),s("span",{style:{color:"#8C862B"}},"props"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#8C862B"}},"name"),s("span",{style:{color:"#8E8F8B"}},"}</"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#1C6B48"}},"default"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8C862B"}},"React"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"memo"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"Child"),s("span",{style:{color:"#8E8F8B"}},");"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A0ADA0"}},"// 这里我们给子组件添加 HOC 实现 Memoization")]),l(`
`),s("span",{class:"line"})])])])])]),s("h2",{id:"类组件实现-memoization",tabindex:"-1"},[l("类组件实现 Memoization "),s("a",{class:"header-anchor",href:"#类组件实现-memoization","aria-hidden":"true"},"#")]),s("p",null,[l("为了在类组件中实现 Memoization，我们将使用 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-api.html%23reactpurecomponent",target:"_blank",rel:"noopener"},"React.PureComponent"),l("。"),s("code",null,"React.PureComponent"),l(" 实现了 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-component.html%23shouldcomponentupdate",target:"_blank",rel:"noopener"},"shouldComponentUpdate()"),l("，它对 "),s("code",null,"state"),l(" 和 "),s("code",null,"props"),l(" 进行了浅比较，并且仅在 props 或 state 发生更改时才重新渲染 React 组件。")]),s("p",null,"将子组件更改为如下所示的代码："),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#758575"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#CB7676"}},"class"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"Child"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"extends"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"React"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"PureComponent"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#758575"}},"// 这里我们把 React.Component 改成了 React.PureComponent")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#A1B567"}},"render"),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"Child render"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#4D9375"}},"return"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"        "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">{"),s("span",{style:{color:"#D4976C"}},"this"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#B8A965"}},"props"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#B8A965"}},"name"),s("span",{style:{color:"#858585"}},"}</"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#4D9375"}},"default"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#B8A965"}},"Child"),s("span",{style:{color:"#858585"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B8A965"}},"复制代码")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#A0ADA0"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#AB5959"}},"class"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"Child"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"extends"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"React"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"PureComponent"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A0ADA0"}},"// 这里我们把 React.Component 改成了 React.PureComponent")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#6C7834"}},"render"),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"Child render"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#1C6B48"}},"return"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"        "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">{"),s("span",{style:{color:"#A65E2B"}},"this"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#8C862B"}},"props"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#8C862B"}},"name"),s("span",{style:{color:"#8E8F8B"}},"}</"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#1C6B48"}},"default"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8C862B"}},"Child"),s("span",{style:{color:"#8E8F8B"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8C862B"}},"复制代码")]),l(`
`),s("span",{class:"line"})])])])])]),s("p",null,[l("此示例的完整代码显示在这个 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Fjwt2q.csb.app%2F",target:"_blank",rel:"noopener"},"sandbox"),l(" 中。")]),s("p",null,[l("父组件保持不变。现在，当我们在父组件中增加 "),s("code",null,"count"),l(" 时，控制台中的输出如下所示：")]),s("pre",null,[s("code",null,[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Child render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"复制代码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}})])])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Child render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"复制代码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}})])])])])])]),s("p",null,[l("对于首次渲染，它同时调用父组件和子组件的 "),s("code",null,"render"),l(" 方法。")]),s("p",null,[l("对于每次增加 "),s("code",null,"count"),l(" 后的重新渲染，仅调用父组件的 "),s("code",null,"render"),l(" 函数。子组件不会重新渲染。")]),s("h2",{id:"react-memo-存在的问题（使用usememo也可以处理）",tabindex:"-1"},[l("React.memo() 存在的问题（使用useMemo也可以处理） "),s("a",{class:"header-anchor",href:"#react-memo-存在的问题（使用usememo也可以处理）","aria-hidden":"true"},"#")]),s("h2",{id:"usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）",tabindex:"-1"},[l("useCallback是uesMemo的一个语法糖（更好的处理函数_直接写） "),s("a",{class:"header-anchor",href:"#usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）","aria-hidden":"true"},"#")]),s("p",null,[l("在上面的示例中，我们看到，当我们对子组件使用 "),s("code",null,"React.memo()"),l(" HOC 时，子组件没有重新渲染，即使父组件重新渲染了。")]),s("p",null,[l("但是，需要注意的一个小问题是，如果我们将函数作为参数传递给子组件，即使在使用 "),s("code",null,"React.memo()"),l(" 之后，子组件也会重新渲染。让我们看一个这样的例子。")]),s("p",null,"我们将更改父组件，如下所示。在这里，我们添加了一个处理函数，并作为参数传递给子组件："),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#758575"}},"//Parent.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#4D9375"}},"default"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"function"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"Parent"),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"["),s("span",{style:{color:"#D4976C"}},"count"),s("span",{style:{color:"#858585"}},","),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#D4976C"}},"setCount"),s("span",{style:{color:"#858585"}},"]"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"useState"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#6394BF"}},"0"),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"handleClick"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"=>"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#A1B567"}},"setCount"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"count"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"+"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#6394BF"}},"1"),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"handler"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"=>"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"handler"'),s("span",{style:{color:"#858585"}},");"),s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#758575"}},"// 这里的 handler 函数将会被传递给子组件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"Parent render"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#4D9375"}},"return"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"className"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#C98A7D"}},'"App"'),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"button"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"onClick"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#B8A965"}},"handleClick"),s("span",{style:{color:"#858585"}},"}>"),s("span",{style:{color:"#DBD7CA"}},"Increment"),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"button"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">{"),s("span",{style:{color:"#B8A965"}},"count"),s("span",{style:{color:"#858585"}},"}</"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#E0A569"}},"Child"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"name"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#C98A7D"}},'"joe"'),s("span",{style:{color:"#858585"}},"}"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"childFunc"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#B8A965"}},"handler"),s("span",{style:{color:"#858585"}},"}"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B8A965"}},"复制代码")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#A0ADA0"}},"//Parent.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#1C6B48"}},"default"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"function"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"Parent"),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"["),s("span",{style:{color:"#A65E2B"}},"count"),s("span",{style:{color:"#8E8F8B"}},","),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A65E2B"}},"setCount"),s("span",{style:{color:"#8E8F8B"}},"]"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"useState"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#296AA3"}},"0"),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"handleClick"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"=>"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#6C7834"}},"setCount"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"count"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"+"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#296AA3"}},"1"),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"handler"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"=>"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"handler"'),s("span",{style:{color:"#8E8F8B"}},");"),s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#A0ADA0"}},"// 这里的 handler 函数将会被传递给子组件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"Parent render"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#1C6B48"}},"return"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"className"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#B56959"}},'"App"'),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"button"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"onClick"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#8C862B"}},"handleClick"),s("span",{style:{color:"#8E8F8B"}},"}>"),s("span",{style:{color:"#393A34"}},"Increment"),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"button"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">{"),s("span",{style:{color:"#8C862B"}},"count"),s("span",{style:{color:"#8E8F8B"}},"}</"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#B58451"}},"Child"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"name"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#B56959"}},'"joe"'),s("span",{style:{color:"#8E8F8B"}},"}"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"childFunc"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#8C862B"}},"handler"),s("span",{style:{color:"#8E8F8B"}},"}"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8C862B"}},"复制代码")]),l(`
`),s("span",{class:"line"})])])])])]),s("p",null,"子组件代码将保持原样。我们不会在子组件中使用父组件传递来的函数："),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#758575"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"function"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"Child"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"props"),s("span",{style:{color:"#858585"}},")"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"Child render"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#4D9375"}},"return"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">{"),s("span",{style:{color:"#B8A965"}},"props"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#B8A965"}},"name"),s("span",{style:{color:"#858585"}},"}</"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#4D9375"}},"default"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#B8A965"}},"React"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"memo"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"Child"),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B8A965"}},"复制代码")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#A0ADA0"}},"//Child.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"function"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"Child"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"props"),s("span",{style:{color:"#8E8F8B"}},")"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"Child render"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#1C6B48"}},"return"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">{"),s("span",{style:{color:"#8C862B"}},"props"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#8C862B"}},"name"),s("span",{style:{color:"#8E8F8B"}},"}</"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#1C6B48"}},"default"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8C862B"}},"React"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"memo"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"Child"),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8C862B"}},"复制代码")]),l(`
`),s("span",{class:"line"})])])])])]),s("p",null,[l("现在，当我们递增父组件中的 "),s("code",null,"count"),l(" 时，它会重新渲染并同时重新渲染子组件，即使传递的参数中没有更改。")]),s("p",null,[l("那么，是什么原因导致子组件重新渲染的呢？答案是，每次父组件重新渲染时，都会创建一个新的 "),s("code",null,"handler"),l(" 函数并将其传递给子组件。现在，由于每次重新渲染时都会重新创建 "),s("code",null,"handle"),l(" 函数，因此子组件在对 props 进行浅比较时会发现 "),s("code",null,"handler"),l(" 引用已更改，并重新渲染子组件。")]),s("h2",{id:"通过-usecallback-来避免更多的重复渲染",tabindex:"-1"},[l("通过 "),s("code",null,"useCallback()"),l(" 来避免更多的重复渲染 "),s("a",{class:"header-anchor",href:"#通过-usecallback-来避免更多的重复渲染","aria-hidden":"true"},"#")]),s("p",null,[l("导致子组件重新渲染的主要问题是重新创建了 "),s("code",null,"handler"),l(" 函数，这更改了传递给子组件的引用。因此，我们需要有一种方法来避免这种重复创建。如果未重新创建 "),s("code",null,"handler"),l(" 函数，则对 "),s("code",null,"handler"),l(" 函数的引用不会更改，因此子组件不会重新渲染。")]),s("p",null,[l("为了避免每次渲染父组件时都重新创建函数，我们将使用一个名为 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Fhooks-reference.html%23usecallback",target:"_blank",rel:"noopener"},"useCallback()"),l(" 的 React Hook。Hooks 是在 React 16 中引入的。要了解有关 Hooks 的更多信息，你可以查看 React 的官方 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Fhooks-intro.html",target:"_blank",rel:"noopener"},"hooks 文档"),l("，或者查看 `"),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.sitepoint.com%2Freact-hooks%2F",target:"_blank",rel:"noopener"},"React Hooks: How to Get Started & Build Your Own"),l('"。')]),s("p",null,[s("code",null,"useCallback()"),l(" 钩子传入两个参数：回调函数和依赖项列表。")]),s("p",null,[l("以下是 "),s("code",null,"useCallback()"),l(" 示例：")]),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#D4976C"}},"handleClick"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"useCallback"),s("span",{style:{color:"#858585"}},"(()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"=>"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"},"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"["),s("span",{style:{color:"#B8A965"}},"x"),s("span",{style:{color:"#858585"}},","),s("span",{style:{color:"#B8A965"}},"y"),s("span",{style:{color:"#858585"}},"]);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B8A965"}},"复制代码")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A65E2B"}},"handleClick"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"useCallback"),s("span",{style:{color:"#8E8F8B"}},"(()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"=>"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"},"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"["),s("span",{style:{color:"#8C862B"}},"x"),s("span",{style:{color:"#8E8F8B"}},","),s("span",{style:{color:"#8C862B"}},"y"),s("span",{style:{color:"#8E8F8B"}},"]);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8C862B"}},"复制代码")]),l(`
`),s("span",{class:"line"})])])])])]),s("p",null,[l("在这里，"),s("code",null,"useCallback()"),l(" 被添加到 "),s("code",null,"handleClick()"),l(" 函数中。第二个参数 "),s("code",null,"[x, y]"),l(" 可以是空数组、单个依赖项或依赖项列表。每当第二个参数中提到的任何依赖项发生更改时，才会重新创建 "),s("code",null,"handleClick()"),l(" 函数。")]),s("p",null,[l("如果 "),s("code",null,"useCallback()"),l(" 中提到的依赖项没有更改，则返回作为第一个参数提及的回调函数的 Memoization 版本。我们将更改父组件，以便对传递给子组件的处理程序使用 "),s("code",null,"useCallback()"),l(" 钩子：")]),s("pre",null,[s("code",{class:"language-js"},[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#758575"}},"//Parent.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#4D9375"}},"export"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#4D9375"}},"default"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"function"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"Parent"),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"["),s("span",{style:{color:"#D4976C"}},"count"),s("span",{style:{color:"#858585"}},","),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#D4976C"}},"setCount"),s("span",{style:{color:"#858585"}},"]"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"useState"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#6394BF"}},"0"),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"handleClick"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"=>"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#A1B567"}},"setCount"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#B8A965"}},"count"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"+"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#6394BF"}},"1"),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#CB7676"}},"const"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#D4976C"}},"handler"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#A1B567"}},"useCallback"),s("span",{style:{color:"#858585"}},"(()"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#CB7676"}},"=>"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#758575"}},"// 给 handler 函数使用 useCallback()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"handler"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},"},"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"[]);")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#B8A965"}},"console"),s("span",{style:{color:"#858585"}},"."),s("span",{style:{color:"#A1B567"}},"log"),s("span",{style:{color:"#858585"}},"("),s("span",{style:{color:"#C98A7D"}},'"Parent render"'),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#4D9375"}},"return"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"className"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#C98A7D"}},'"App"'),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"button"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"onClick"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#B8A965"}},"handleClick"),s("span",{style:{color:"#858585"}},"}>"),s("span",{style:{color:"#DBD7CA"}},"Increment"),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"button"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">{"),s("span",{style:{color:"#B8A965"}},"count"),s("span",{style:{color:"#858585"}},"}</"),s("span",{style:{color:"#429988"}},"h2"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"      "),s("span",{style:{color:"#858585"}},"<"),s("span",{style:{color:"#E0A569"}},"Child"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"name"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#C98A7D"}},'"joe"'),s("span",{style:{color:"#858585"}},"}"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#E0A569"}},"childFunc"),s("span",{style:{color:"#CB7676"}},"="),s("span",{style:{color:"#858585"}},"{"),s("span",{style:{color:"#B8A965"}},"handler"),s("span",{style:{color:"#858585"}},"}"),s("span",{style:{color:"#DBD7CA"}}," "),s("span",{style:{color:"#858585"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"    "),s("span",{style:{color:"#858585"}},"</"),s("span",{style:{color:"#429988"}},"div"),s("span",{style:{color:"#858585"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#DBD7CA"}},"  "),s("span",{style:{color:"#858585"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#858585"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B8A965"}},"复制代码")]),l(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#A0ADA0"}},"//Parent.js")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#1C6B48"}},"export"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#1C6B48"}},"default"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"function"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"Parent"),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"["),s("span",{style:{color:"#A65E2B"}},"count"),s("span",{style:{color:"#8E8F8B"}},","),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A65E2B"}},"setCount"),s("span",{style:{color:"#8E8F8B"}},"]"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"useState"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#296AA3"}},"0"),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"handleClick"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"=>"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#6C7834"}},"setCount"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#8C862B"}},"count"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"+"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#296AA3"}},"1"),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},"};")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#AB5959"}},"const"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A65E2B"}},"handler"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#6C7834"}},"useCallback"),s("span",{style:{color:"#8E8F8B"}},"(()"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#AB5959"}},"=>"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#A0ADA0"}},"// 给 handler 函数使用 useCallback()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"handler"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},"},"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"[]);")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8C862B"}},"console"),s("span",{style:{color:"#8E8F8B"}},"."),s("span",{style:{color:"#6C7834"}},"log"),s("span",{style:{color:"#8E8F8B"}},"("),s("span",{style:{color:"#B56959"}},'"Parent render"'),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#1C6B48"}},"return"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"(")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"className"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#B56959"}},'"App"'),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"button"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"onClick"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#8C862B"}},"handleClick"),s("span",{style:{color:"#8E8F8B"}},"}>"),s("span",{style:{color:"#393A34"}},"Increment"),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"button"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">{"),s("span",{style:{color:"#8C862B"}},"count"),s("span",{style:{color:"#8E8F8B"}},"}</"),s("span",{style:{color:"#2F8A89"}},"h2"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"      "),s("span",{style:{color:"#8E8F8B"}},"<"),s("span",{style:{color:"#B58451"}},"Child"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"name"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#B56959"}},'"joe"'),s("span",{style:{color:"#8E8F8B"}},"}"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#B58451"}},"childFunc"),s("span",{style:{color:"#AB5959"}},"="),s("span",{style:{color:"#8E8F8B"}},"{"),s("span",{style:{color:"#8C862B"}},"handler"),s("span",{style:{color:"#8E8F8B"}},"}"),s("span",{style:{color:"#393A34"}}," "),s("span",{style:{color:"#8E8F8B"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"    "),s("span",{style:{color:"#8E8F8B"}},"</"),s("span",{style:{color:"#2F8A89"}},"div"),s("span",{style:{color:"#8E8F8B"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393A34"}},"  "),s("span",{style:{color:"#8E8F8B"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8E8F8B"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#8C862B"}},"复制代码")]),l(`
`),s("span",{class:"line"})])])])])]),s("p",null,"子组件代码将保持原样。"),s("p",null,[l("此示例的完整代码这个 "),s("a",{href:"https://link.juejin.cn?target=https%3A%2F%2Fr797x.csb.app%2F",target:"_blank",rel:"noopener"},"sandbox"),l(" 中。")]),s("p",null,[l("当我们在上述代码的父组件中增加 "),s("code",null,"count"),l(" 时，我们可以看到以下输出：")]),s("pre",null,[s("code",null,[s("div",{class:"shiki-container"},[s("pre",{class:"shiki shiki-dark",style:{"background-color":"#121212"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Child render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}},"复制代码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#dbd7ca"}})])])]),s("pre",{class:"shiki shiki-light",style:{"background-color":"#ffffff"}},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Child render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"Parent render")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}},"复制代码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#393a34"}})])])])])])]),s("p",null,[l("由于我们对父组件中的 "),s("code",null,"handler"),l(" 使用了 "),s("code",null,"useCallback()"),l(" 钩子，因此每次父组件重新渲染时，都不会重新创建 "),s("code",null,"handler"),l(" 函数，并且会将 "),s("code",null,"handler"),l(" 的 Memoization 版本传递到子组件。子组件将进行浅比较，并注意到 "),s("code",null,"handler"),l(" 函数的引用没有更改，因此它不会调用 "),s("code",null,"render"),l(" 方法。")]),s("h2",{id:"值得注意的事",tabindex:"-1"},[l("值得注意的事 "),s("a",{class:"header-anchor",href:"#值得注意的事","aria-hidden":"true"},"#")]),s("p",null,"Memoization 是一种很好的手段，可以避免在组件的 state 或 props 没有改变时对组件进行不必要的重新渲染，从而提高 React 应用的性能。你可能会考虑为所有组件添加 Memoization，但这并不一定是构建高性能 React 组件的方法。只有在组件出现以下情况时，才应使用 Memoization："),s("ul",null,[s("li",null,"固定的输入有固定的输出时"),s("li",null,"具有较多 UI 元素，虚拟 DOM 检查将影响性能"),s("li",null,"多次传递相同的参数")]),s("h2",{id:"总结",tabindex:"-1"},[l("总结 "),s("a",{class:"header-anchor",href:"#总结","aria-hidden":"true"},"#")]),s("p",null,"在本教程中，我们理解了："),s("ul",null,[s("li",null,"React 是如何渲染 UI 的"),s("li",null,"为什么需要 Memoization"),s("li",null,[l("如何在 React 中通过函数组件的 "),s("code",null,"React.memo()"),l(" 和类组件的 "),s("code",null,"React.PureComponent"),l(" 实现 Memoization")]),s("li",null,[l("通过一个例子展示，即使在使用 "),s("code",null,"React.memo()"),l(" 之后，子组件也会重新渲染")]),s("li",null,[l("如何使用 "),s("code",null,"useCallback()"),l(" 钩子来避免在函数作为 props 传递给子组件时产生重新渲染的问题")])]),s("h2",{id:"斐波那契数列-缓存",tabindex:"-1"},[l("斐波那契数列 缓存 "),s("a",{class:"header-anchor",href:"#斐波那契数列-缓存","aria-hidden":"true"},"#")])],-1),D="Memoization",u="2022-08-24T16:00:00.000Z",h="zh",F="9min",E=[{property:"og:title",content:"Memoization"}],m={__name:"memoization",setup(i,{expose:n}){const o={title:"Memoization",date:"2022-08-24T16:00:00.000Z",lang:"zh",duration:"9min",meta:[{property:"og:title",content:"Memoization"}]};return n({frontmatter:o}),a({title:"Memoization",meta:[{property:"og:title",content:"Memoization"}]}),(A,C)=>{const e=r;return p(),c(e,{frontmatter:o},{default:t(()=>[y]),_:1})}}};export{u as date,m as default,F as duration,h as lang,E as meta,D as title};
